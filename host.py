from shodan import Shodan
import pprint
pp = pprint.PrettyPrinter(depth=16)


api = Shodan('hRyW5EDhFjJQhAmz5TVKKpYQUZR8Vxnw')

# Lookup an IP
ipinfo = api.host('27.0.12.157')
pp.pprint(ipinfo)

# # Search for websites that have been "hacked"
# for banner in api.search_cursor('http.title:"hacked by"'):
#     print(banner)

# # Get the total number of industrial control systems services on the Internet
# ics_services = api.count('tag:ics')
# print('Industrial Control Systems: {}'.format(ics_services['total']))